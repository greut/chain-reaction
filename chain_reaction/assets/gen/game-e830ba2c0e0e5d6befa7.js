!function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=9)}([function(e,t){e.exports=jQuery},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=(0,f.default)("h2"),n=t.find("b");n[0].innerText=e[0],n[1].innerText=e[1]}function i(){var e=(0,f.default)("#status");m!=c?e.addClass("alert-info").removeClass("alert-success").text("Attente de l'autre joueur..."):e.addClass("alert-success").removeClass("alert-info").text("Ã€ vous de jouer!")}function a(){var e=[0,0];return w.forEach(function(t){t.forEach(function(t){"undefined"!=typeof t.player&&(e[t.player]+=t.selectedCircles)})}),e}function l(e,t){s=new p.default.Canvas(t[0]),c=t.data("num");var n=!1;e.onmessage=function(t){var o=JSON.parse(t.data);console.log(o),"done"===o.action?(console.log("game is done"),"url"in o&&(window.location=o.url)):"start"===o.action?(console.log("game is starting"),k=o.plays.length?o.plays[o.plays.length-1].turn:0,n||(n=!0,J(o.plays.slice()))):"play"===o.action&&(k=o.tick,f(w[o.x][o.y],function(){var t=a();if(r(t),i(),m!==c&&e.send(JSON.stringify({tick:k,player:c,action:"score",score:t})),x>=2&&t.indexOf(0)>-1){if(m!==c){alert("You win!");var n={action:"close",tick:k,player:c};e.send(JSON.stringify(n))}else alert("You lose!");s.off("mouse.down",l),e.close()}}))},e.onopen=function(){e.send(JSON.stringify({action:"start"}))};var o=function(){x++,m=0===m?1:0,s.backgroundColor=g[m],s.renderAll(!0)},l=function(t){if(s.deactivateAll(),0===c&&0===m||1===c&&1===m){var n;if("undefined"!=typeof t.target){"rect"===t.target.type?n=t.target:"circle"===t.target.type&&(n=t.target.square);var o={tick:++k,player:c,action:"play",x:n.xposition,y:n.yposition};e.send(JSON.stringify(o))}}},u=function(e,t){var n=e.selectedCircles;0===e.selectedCircles&&"#e5e5e5"===t&&(n=e.maxCircles);for(var o=0;o<n;o++)e.circles[o].set("fill",t),s.renderAll(!0)},f=function(e,t){if(e.initialState&&(e.initialState=!1,e.player=m),e.player===m)if(e.selectedCircles+=1,e.selectedCircles<e.maxCircles&&(e.player=m,u(e,g[m]),o()),e.selectedCircles===e.maxCircles){var n=[e],r=function e(){var r=n.shift();"undefined"!=typeof r?(d(r,n),window.setTimeout(e)):(o(),t&&t())};window.setTimeout(r,0)}else t&&t()},d=function(e,t){e.selectedCircles=0,u(e,"#e5e5e5"),e.initialState=!0;for(var n=0;n<O.length;n++){var o=e.xposition+O[n].x,r=e.yposition+O[n].y;if(!(o<0||r<0||o>v-1||r>v-1)){var i=w[o][r];i.selectedCircles+=1,i.selectedCircles===i.maxCircles?t.push(i):i.selectedCircles<i.maxCircles&&(i.initialState&&(i.initialState=!1),i.player=m,u(i,g[m]))}}},b=function(){s.backgroundColor=g[0],s.setDimensions({width:v*y+1,height:v*y+1});for(var e=0;e<v;e++){for(var t=[],n=0;n<v;n++){var o=new p.default.Rect(C);o.xposition=e,o.yposition=n,o.initialState=!0,0!==e&&e!==v-1||0!==n&&n!==v-1?0===e||0===n||e===v-1||n===v-1?o.maxCircles=3:o.maxCircles=4:o.maxCircles=2,C.left+=y,t.push(o),s.add(o)}w.push(t),C.left=1,C.top+=y}for(var e=0;e<2*v;e++){for(var r,n=0;n<2*v;n++){if(n%2===0){var i=e%2===0?e/2:(e-1)/2;r=w[i][n/2],void 0===r.circles&&(r.circles=[],r.selectedCircles=0)}var a=new p.default.Circle(h);a.square=r,h.left+=S,r.circles.push(a),s.add(a)}h.left=3,h.top+=S}},N=function(){m=0,x=0,w=[],s.clear(),C.left=1,C.top=1,h.left=4,h.top=4,b(),s.renderAll(!0)},J=function(e){function t(){e.length?f(w[e[0].x][e[0].y],function(){r(a()),e.shift(),window.setTimeout(t,200)}):(i(),s.on("mouse:down",l))}N(),window.setTimeout(t,200)}}var s,c,u=n(0),f=o(u),d=n(8),p=o(d),v=8,y=60,m=0,x=0,g=["red","green"],C={left:1,top:1,fill:"#e5e5e5",width:y-1,height:y-1,hoverCursor:"pointer",selectable:!0,lockMovementX:!0,lockMovementY:!0,lockRotation:!0,hasControls:!1},h={radius:y/5,fill:"#e5e5e5",left:4,top:4,hoverCursor:"pointer",selectable:!0,lockMovementX:!0,lockMovementY:!0,lockRotation:!0,hasControls:!1,hasBorders:!1},w=[],S=y/2,k=0,O=[{x:-1,y:0},{x:0,y:-1},{x:0,y:1},{x:1,y:0}];e.exports=l},function(e,t,n){"use strict";function o(e){e.onopen=function(t){e.send(JSON.stringify({action:"join"}))},e.onmessage=function(e){var t=JSON.parse(e.data);"url"in t&&(window.location=t.url)}}e.exports=o},,function(e,t){},,,,function(e,t){e.exports=fabric},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}var r=n(0),i=o(r),a=n(2),l=o(a),s=n(1),c=o(s);n(4);var u="O";(0,i.default)(function(){var e="https:"===document.location.protocol?"wss:":"ws:",t="8000"===document.location.port?8001:document.location.port,n=(0,i.default)("#game"),o=n.data("ws");if(!o)return void console.error("no game found.");var r=new WebSocket(e+"//"+location.hostname+":"+t+"/ws"+o);n.data("type")==u?(0,l.default)(r):(0,c.default)(r,n),r.readyState==WebSocket.OPEN&&r.onopen()})}]);